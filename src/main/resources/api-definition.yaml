#%RAML 0.8
---
title: OpenLMIS Requisition API
version: "1.0.0"
baseUri: "${baseUrl}/api"

documentation:
    - title: Getting Started
      content: Welcome to the OpenLMIS requisition-service documentation. This minimal API is intended for illustrative purposes.

schemas:
  - facility: |
      {
          "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "Facility",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "code": { "type": "string", "required": true, "title": "code" },
              "name": { "type": "string", "required": false, "title": "name" },
              "description": { "type": "string", "required": false, "title": "description" },
              "geographicZone": { "type": "string", "required": true, "title": "geographicZone" },
              "type": { "type": "string", "required": true, "title": "type" },
              "operator": { "type": "string", "required": false, "title": "operator" },
              "active": { "type": "boolean", "required": true, "title": "active" },
              "goLiveDate": { "type": "string", "required": false, "title": "goLiveDate" },
              "goDownDate": { "type": "string", "required": false, "title": "goDownDate" },
              "comment": { "type": "string", "required": false, "title": "comment" },
              "enabled": { "type": "boolean", "required": true, "title": "enabled" }
          }
      }

  - facilityOperator: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "FacilityOperator",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "code": { "type": "string", "required": true, "title": "code" },
              "name": { "type": "string", "required": false, "title": "name" },
              "description": { "type": "string", "required": false, "title": "description" },
              "displayOrder": { "type": "integer", "required": false, "title": "displayOrder" }
          }
      }

  - facilityType: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "FacilityType",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "code": { "type": "string", "required": true, "title": "code" },
              "name": { "type": "string", "required": false, "title": "name" },
              "description": { "type": "string", "required": false, "title": "description" },
              "displayOrder": { "type": "integer", "required": false, "title": "displayOrder" },
              "active": { "type": "boolean", "required": false, "title": "active" }
          }
      }

  - facilityTypeApprovedProduct: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "FacilityTypeApprovedProduct",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "facilityType": { "type": "string", "required": true, "title": "facilityType" },
              "programProduct": { "type": "string", "required": true, "title": "programProduct" },
              "maxMonthsOfStock": { "type": "number", "required": true, "title": "maxMonthsOfStock" },
              "minMonthsOfStock": { "type": "number", "required": false, "title": "minMonthsOfStock" },
              "emergencyOrderPoint": { "type": "number", "required": false, "title": "emergencyOrderPoint" }
          }
      }

  - geographicLevel: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "GeographicLevel",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "code": { "type": "string", "required": true, "title": "code" },
              "name": { "type": "string", "required": true, "title": "name" },
              "levelNumber": { "type": "integer", "required": true, "title": "levelNumber" }
          }
      }

  - geographicZone: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "GeographicZone",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "code": { "type": "string", "required": true, "title": "code" },
              "name": { "type": "string", "required": false, "title": "name" },
              "level": { "type": "string", "required": true, "title": "level" },
              "catchmentPopulation": { "type": "integer", "required": false, "title": "catchmentPopulation" },
              "latitude": { "type": "number", "required": false, "title": "latitude" },
              "longitude": { "type": "number", "required": false, "title": "longitude" }
          }
      }

  - order: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "Order",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "requisitionCode": { "type": "string", "required": false, "title": "requisitionCode" },
              "createdDate": { "type": "string", "required": false, "title": "createdDate" },
              "createdBy": { "type": "string", "required": true, "title": "createdBy" }, "program": { "type": "string", "required": true, "title":"program" },
              "requestingFacility": { "type": "string", "required": true, "title": "requestingFacility" },
              "receivingFacilityId": { "type": "string", "required": true, "title": "receivingFacilityId" },
              "supplyingFacilityId": { "type": "string", "required": true, "title": "supplyingFacilityId" },
              "orderCode": { "type": "string", "required": true, "title": "orderCode" },
              "status": { "type": "string", "required": true, "title": "status" },
              "quotedCost": { "type": "integer", "required": true, "title": "quotedCost" },
              "orderLines": { "type": "array", "required": false, "title": "orderLines", "items": { "type": "string" }, "uniqueItems": false }
          }
      }

  - orderLine: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "OrderLine",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "product": { "type": "string", "required": true, "title": "product" },
              "orderedQuantity": { "type": "integer", "required": true, "title": "orderedQuantity" },
              "order": { "type": "string", "required": false, "title": "order" }
          }
      }

  - period: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "Period",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "processingSchedule": { "type": "string", "required": true, "title": "processingSchedule" },
              "name": { "type": "string", "required": true, "title": "name" },
              "description": { "type": "string", "required": false, "title": "description" },
              "startDate": { "type": "string", "required": true, "title": "startDate" },
              "endDate": { "type": "string", "required": true, "title": "endDate" }
          }
      }

  - product: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "Product",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "code": { "type": "string", "required": true, "title": "code" },
              "primaryName": { "type": "string", "required": true, "title": "primaryName" },
              "dispensingUnit": { "type": "string", "required": true, "title": "dispensingUnit" },
              "dosesPerDispensingUnit": { "type": "integer", "required": true, "title": "dosesPerDispensingUnit" },
              "packSize": { "type": "integer", "required": true, "title": "packSize" },
              "packRoundingThreshold": { "type": "integer", "required": true, "title": "packRoundingThreshold" },
              "roundToZero": { "type": "boolean", "required": true, "title": "roundToZero" },
              "active": { "type": "boolean", "required": true, "title": "active" },
              "fullSupply": { "type": "boolean", "required": true, "title": "fullSupply" },
              "tracer": { "type": "boolean", "required": true, "title": "tracer" }
          }
      }

  - productCategory: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "ProductCategory",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "code": { "type": "string", "required": true, "title": "code" },
              "name": { "type": "string", "required": true, "title": "name" },
              "displayOrder": { "type": "integer", "required": true, "title": "displayOrder" }
          }
      }

  - program: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "Program",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "code": { "type": "string", "required": true, "title": "code" },
              "name": { "type": "string", "required": false, "title": "name" },
              "description": { "type": "string", "required": false, "title": "description" },
              "active": { "type": "boolean", "required": false, "title": "active" },
              "skippable": { "type": "boolean", "required": true, "title": "skippable" },
              "showNonFullSupplyTab": { "type": "boolean", "required": false, "title": "showNonFullSupplyTab" }
          }
      }

  - programProduct: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "ProgramProduct",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "program": { "type": "string", "required": true, "title": "program" },
              "product": { "type": "string", "required": true, "title": "product" },
              "dosesPerMonth": { "type": "integer", "required": true, "title": "dosesPerMonth" },
              "active": { "type": "boolean", "required": true, "title": "active" },
              "productCategory": { "type": "string", "required": true, "title": "productCategory" },
              "fullSupply": { "type": "boolean", "required": true, "title": "fullSupply" },
              "displayOrder": { "type": "integer", "required": false, "title": "displayOrder" },
              "maxMonthsStock": { "type": "integer", "required": false, "title": "maxMonthsStock" },
              "pricePerPack": { "type": "string", "required": false, "title": "pricePerPack" }
          }
      }

  - requisition: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "Requisition",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "createdDate": { "type": "string", "required": false, "title": "createdDate" },
              "facility": { "type": "string", "required": true, "title": "facility" },
              "program": { "type": "string", "required": true, "title": "program" },
              "processingPeriod": { "type": "string", "required": true, "title": "processingPeriod" },
              "status": { "type": "string", "required": true, "title": "status" },
              "creator": { "type": "string", "required": false, "title": "creator" },
              "requisitionLines": { "type": "array", "required": false, "title": "requisitionLines", "items": { "type": "string" }, "uniqueItems": false }
          }
      }

  - requisitionLine: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "RequisitionLine",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "requisition": { "type": "string", "required": true, "title": "requisition" },
              "product": { "type": "string", "required": true, "title": "product" },
              "quantityRequested": { "type": "integer", "required": false, "title": "quantityRequested" }
          }
      }

  - requisitionTemplate: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "RequisitionTemplate",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "program": { "type": "string", "required": true, "title": "program" },
              "columnsMap": { "type": "array", "required": false, "title": "columnsMap", "items": { "type": "string", "title": "columnsMap" }, "uniqueItems": false }
          }
      }

  - requisitionTemplateColumn: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "RequisitionTemplateColumn",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "name": { "type": "string", "required": false, "title": "name" },
              "label": { "type": "string", "required": false, "title": "label" },
              "displayOrder": { "type": "integer", "required": false, "title": "displayOrder" },
              "isDisplayed": { "type": "boolean", "required": false, "title": "isDisplayed" },
              "isDisplayRequired": { "type": "boolean", "required": false, "title": "isDisplayRequired" },
              "canChangeOrder": { "type": "boolean", "required": false, "title": "canChangeOrder" },
              "source": { "type": "string", "required": false, "title": "source" }
          }
      }

  - right: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "Right",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "name": { "type": "string", "required": true, "title": "name" },
              "rightType": { "type": "string", "required": true, "title": "rightType" },
              "description": { "type": "string", "required": false, "title": "description" }
          }
      }

  - role: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "Role",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "name": { "type": "string", "required": true, "title": "name" },
              "description": { "type": "string", "required": false, "title": "description" },
              "rights": { "type": "array", "required": false, "title": "rights",
              "items": { "type": "string" }, "uniqueItems": false }
          }
      }

  - schedule: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "Schedule",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "code": { "type": "string", "required": true, "title": "code" },
              "description": { "type": "string", "required": false, "title": "description" },
              "modifiedDate": { "type": "string", "required": false, "title": "modifiedDate" },
              "name": { "type": "string", "required": true, "title": "name" }
          }
      }

  - user: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "User",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "username": { "type": "string", "required": true, "title": "username" },
              "password": { "type": "string", "required": true, "title": "password" },
              "firstName": { "type": "string", "required": true, "title": "firstName" },
              "lastName": { "type": "string", "required": true, "title": "lastName" },
              "homeFacility": { "type": "string", "required": false, "title": "homeFacility" },
              "verified": { "type": "boolean", "required": false, "title": "verified" },
              "active": { "type": "boolean", "required": false, "title": "active" },
              "roles": { "type": "array", "required": false, "title": "roles", "items": { "type": "object" }, "uniqueItems": false}
          }
      }

resourceTypes:
    - collection:
        get:
            responses:
                200:
                  description: Collection retrieved successfully
                  headers:
                    X-Content-Type-Options:
                    X-XSS-Protection:
                  body:
                      application/json:
                          schema: <<schema>>
                404:
                  description: Collection is empty.
                  headers:
                    X-Content-Type-Options:
                    X-XSS-Protection:
        post:
            body:
                application/json:
                    schema: <<schema>>
            responses:
                201:
                  description: Item created successfully
                  headers:
                    X-Content-Type-Options:
                    X-XSS-Protection:
                  body:
                      application/json:
                          schema: <<schema>>
    - member:
        get:
            responses:
                200:
                    body:
                        application/json:
                            schema: <<schema>>
        post:
            body:
                application/json:
                    schema: <<schema>>
            responses:
                200:
                    body:
                        application/json:
                            schema: <<schema>>
        delete:
            responses:
                200:

/orders:
    displayName: Order
    /csv/{id}:
        uriParameters:
            id:
                displayName: Order id
                type: string
        get:
            description: Get CSV from Order
            responses:
              200:
                headers:
                  X-Content-Type-Options:
                  X-XSS-Protection:
                body:
                  application/json:
              400:
                headers:
                  X-Content-Type-Options:
                  X-XSS-Protection:

/programs:
    displayName: ProgramsResource
    /update:
        post:
          description: Update a program
          body:
            application/json:
              schema: |
                {   "$schema": "http://json-schema.org/draft-03/schema",
                    "type": "object",
                    "properties": {
                        "id": { "type": "string", "required": true},
                        "code":  { "type": "string", "required": true },
                        "name":  { "type": "string", "required": false }
                    }
                }
          responses:
            201:
              description: Program sucessfully updated.
              headers:
                X-Content-Type-Options:
                X-XSS-Protection:
              body:
                application/json:
                  schema: program

/schedules:
    displayName: Schedule
    /{id}/difference:
        uriParameters:
            id:
                displayName: Schedule id
                type: string
        get:
            description: Get total difference
            responses:
              200:
                headers:
                  X-Content-Type-Options:
                  X-XSS-Protection:
                body:
                  application/json:
              404:
                headers:
                  X-Content-Type-Options:
                  X-XSS-Protection:



