#%RAML 0.8
---
title: OpenLMIS Requisition API
version: "1.0.0"
baseUri: "${baseUrl}/api"

documentation:
    - title: Getting Started
      content: Welcome to the OpenLMIS requisition-service documentation. This minimal API is intended for illustrative purposes.

schemas:
  - geographicLevel: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "GeographicLevel",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "code": { "type": "string", "required": true, "title": "code" },
              "name": { "type": "string", "required": true, "title": "name" },
              "levelNumber": { "type": "integer", "required": true, "title": "levelNumber" }
          }
      }
  - geographicZone: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "GeographicZone",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "code": { "type": "string", "required": true, "title": "code" },
              "name": { "type": "string", "required": false, "title": "name" },
              "level": { "type": "object", "$ref": "#/schemas/geographicLevel",
              "required": true, "title": "level" },
              "catchmentPopulation": { "type": "integer",
              "required": false, "title": "catchmentPopulation" },
              "latitude": { "type": "number", "required": false, "title": "latitude" },
              "longitude": { "type": "number", "required": false, "title": "longitude" }
          }
      }
  - program: |
      {   "$schema": "http://json-schema.org/draft-03/schema",
          "description": "A single program",
          "type": "object",
          "properties": {
              "id": { "type": "string", "required": true},
              "code":  { "type": "string", "required": true },
              "name":  { "type": "string", "required": false },
              "description":  { "type": "string", "required": false },
              "active":  { "type": "boolean", "required": false },
              "skippable":  { "type": "boolean", "required": true },
              "showNonFullSupplyTab":  { "type": "boolean", "required": false }
          }
      }
  - product: |
      {   "type": "object",
          "$schema": "http://json-schema.org/draft-03/schema",
          "title": "Product",
          "properties": {
              "id": { "type": "string", "required": true, "title": "id" },
              "code": { "type": "string", "required": true, "title": "code" },
              "primaryName": { "type": "string", "required": true, "title": "primaryName" },
              "dispensingUnit": { "type": "string", "required": true, "title": "dispensingUnit" },
              "dosesPerDispensingUnit": { "type": "integer", "required": true, "title": "dosesPerDispensingUnit" },
              "packSize": { "type": "integer", "required": true, "title": "packSize" },
              "packRoundingThreshold": { "type": "integer", "required": true, "title": "packRoundingThreshold" },
              "roundToZero": { "type": "boolean", "required": true, "title": "roundToZero" },
              "active": { "type": "boolean", "required": true, "title": "active" },
              "fullSupply": { "type": "boolean", "required": true, "title": "fullSupply" },
              "tracer": { "type": "boolean", "required": true, "title": "tracer" }
          }
      }

resourceTypes:
    - collection:
        get:
            responses:
                200:
                  description: Collection retrieved successfully
                  headers:
                    X-Content-Type-Options:
                    X-XSS-Protection:
                  body:
                      application/json:
                          schema: <<schema>>
                404:
                  description: Collection is empty.
                  headers:
                    X-Content-Type-Options:
                    X-XSS-Protection:
        post:
            body:
                application/json:
                    schema: <<schema>>
            responses:
                201:
                  description: Item created successfully
                  headers:
                    X-Content-Type-Options:
                    X-XSS-Protection:
                  body:
                      application/json:
                          schema: <<schema>>
    - member:
        get:
            responses:
                200:
                    body:
                        application/json:
                            schema: <<schema>>
        post:
            body:
                application/json:
                    schema: <<schema>>
            responses:
                200:
                    body:
                        application/json:
                            schema: <<schema>>
        delete:
            responses:
                200:


/programs:
    displayName: ProgramsResource
    /update:
        post:
          description: Update a program
          body:
            application/json:
              schema: |
                {   "$schema": "http://json-schema.org/draft-03/schema",
                    "type": "object",
                    "properties": {
                        "id": { "type": "string", "required": true},
                        "code":  { "type": "string", "required": true },
                        "name":  { "type": "string", "required": false }
                    }
                }
          responses:
            201:
              description: Program sucessfully updated.
              headers:
                X-Content-Type-Options:
                X-XSS-Protection:
              body:
                application/json:
                  schema: program

/schedules:
    displayName: Schedule
    /{id}/difference:
        uriParameters:
            id:
                displayName: Schedule id
                type: string
        get:
            description: Get total difference
            responses:
              200:
                headers:
                  X-Content-Type-Options:
                  X-XSS-Protection:
                body:
                  application/json:
              404:
                headers:
                  X-Content-Type-Options:
                  X-XSS-Protection:
